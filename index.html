<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Klipprr | Memory-Shares</title>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Firebase SDK (compat for plain HTML) -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<style>
* { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body { display:flex; min-height:100vh; background-color:#f5f7fa; color:#333; }

/* Sidebar */
.sidebar { width:220px; background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%); color:white; padding:25px 0; box-shadow:3px 0 10px rgba(0,0,0,0.1); position:fixed; height:100vh; z-index:100; }
.logo { text-align:center; padding:0 20px 30px; border-bottom:1px solid rgba(255,255,255,0.2); margin-bottom:30px; }
.logo h1 { font-size:1.8rem; font-weight:600; color:#e94560; }
.nav-links { list-style:none; padding:0 20px; }
.nav-links li { margin-bottom:15px; }
.nav-links a { display:flex; align-items:center; color:white; text-decoration:none; padding:12px 15px; border-radius:8px; transition:all 0.3s ease; }
.nav-links a:hover, .nav-links a.active { background-color:rgba(233,69,96,0.2); transform:translateX(5px); }
.nav-links i { margin-right:12px; font-size:1.2rem; }

/* Main content */
.main-content { flex:1; margin-left:220px; padding:30px; }

/* Sticky Header */
.header {
    position: sticky;
    top: 0;
    z-index: 50;
    background-color: #f5f7fa;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 0;
    border-bottom: 1px solid #e0e6ed;
}
.header h2 { font-size:1.8rem; color:#2c3e50; font-weight:600; }

/* Grid */
.grid-container { display:grid; grid-template-columns: repeat(auto-fill, minmax(220px,1fr)); gap:20px; }
.grid-item { background-color:white; border-radius:10px; padding:10px; box-shadow:0 4px 6px rgba(0,0,0,0.05); display:flex; flex-direction:column; justify-content:center; align-items:center; transition: transform 0.3s ease, box-shadow 0.3s ease; }
.grid-item:hover { transform:translateY(-5px); box-shadow:0 10px 15px rgba(0,0,0,0.1); }
.grid-item video { width:100%; height:auto; object-fit:cover; border-radius:10px; }
.grid-item .label { font-size:0.9rem; color:#7f8c8d; text-align:center; margin-top:8px; }

/* Upload page */
.upload-container { background:white; border-radius:10px; padding:30px; box-shadow:0 4px 6px rgba(0,0,0,0.05); max-width:600px; margin:0 auto; }
.upload-header { text-align:center; margin-bottom:30px; }
.upload-header h2 { color:#2c3e50; margin-bottom:10px; }
.upload-header p { color:#7f8c8d; }
.upload-area { border:2px dashed #bdc3c7; border-radius:8px; padding:40px 20px; text-align:center; margin-bottom:20px; cursor:pointer; transition:all 0.3s ease; }
.upload-area:hover { border-color:#e94560; background-color:#f8f9fa; }
.upload-icon { font-size:3rem; color:#bdc3c7; margin-bottom:15px; }
.upload-btn { background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%); color:white; border:none; padding:12px 25px; border-radius:8px; font-size:1rem; font-weight:600; cursor:pointer; display:block; width:100%; margin-top:20px; transition:all 0.3s ease; }
.upload-btn:hover { transform:translateY(-2px); box-shadow:0 5px 15px rgba(26,26,46,0.3); }

/* Page content */
.page-content { display:none; }
.page-content.active { display:block; }

/* Responsive */
@media(max-width:1024px){.grid-container{grid-template-columns:repeat(2,1fr);}}
@media(max-width:768px){
.sidebar{width:70px;padding:20px 0;}
.logo h1,.nav-links span{display:none;}
.nav-links a{justify-content:center;padding:15px;}
.nav-links i{margin-right:0;font-size:1.4rem;}
.main-content{margin-left:70px;}
.grid-container{grid-template-columns:1fr;}
}
</style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar">
  <div class="logo"><h1>Klipprr</h1></div>
  <ul class="nav-links">
    <li><a href="#" class="nav-link active" data-page="home"><i class="fas fa-home"></i><span>Home</span></a></li>
    <li><a href="#" class="nav-link" data-page="upload"><i class="fas fa-cloud-upload-alt"></i><span>Upload</span></a></li>
  </ul>
</div>

<!-- Main Content -->
<div class="main-content">
  <div class="header"><h2 id="page-title">Homepage</h2></div>

  <!-- Home Page -->
  <div id="home" class="page-content active">
    <div class="grid-container" id="grid-container"></div>
  </div>

  <!-- Upload Page -->
  <div id="upload" class="page-content">
    <div class="upload-container">
      <div class="upload-header">
        <h2>Upload Video</h2>
        <p>Enter title and select a video file</p>
      </div>
      <input type="text" id="video-title" placeholder="Video title" style="width:100%;padding:10px;margin-bottom:15px;border-radius:5px;border:1px solid #ccc;">
      <div class="upload-area" id="upload-area">
        <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
        <h3>Select Video</h3>
        <p>Formats: mp4, mov (No limit)</p>
      </div>
      <button class="upload-btn" id="upload-btn">Upload</button>
      <p id="upload-confirm" style="color:green;margin-top:10px;display:none;">Video uploaded successfully!</p>
    </div>
  </div>
</div>

<script>
/* --- Firebase setup --- */
const firebaseConfig = {
  apiKey: "AIzaSyBjnsGDDIr7QiolBgkJAZUGGk0KoMO5fx4",
  authDomain: "memory-shares.firebaseapp.com",
  projectId: "memory-shares",
  storageBucket: "memory-shares.appspot.com",
  messagingSenderId: "427997619373",
  appId: "1:427997619373:web:dedd1d2b39465c1e6dd224",
  measurementId: "G-WH5BY0TKZ6"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* --- Cloudinary setup --- */
const cloudName = 'dfkh6wkyt'; 
const unsignedUploadPreset = 'upload'; 

/* --- Page Navigation --- */
document.querySelectorAll('.nav-link').forEach(link=>{
  link.addEventListener('click',function(e){
    e.preventDefault();
    document.querySelectorAll('.nav-link').forEach(l=>l.classList.remove('active'));
    this.classList.add('active');
    const pageId=this.getAttribute('data-page');
    document.querySelectorAll('.page-content').forEach(page=>page.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
    document.getElementById('page-title').textContent = (pageId==='home')?'Homepage':'Upload Video';
  });
});

/* --- Cloudinary Upload --- */
let selectedFile = null;
const uploadArea = document.getElementById('upload-area');
const uploadBtn = document.getElementById('upload-btn');
const titleInput = document.getElementById('video-title');
const confirmMsg = document.getElementById('upload-confirm');

uploadArea.addEventListener('click',()=>{ 
  const input = document.createElement('input');
  input.type='file';
  input.accept='video/*';
  input.onchange = e=>{ 
    selectedFile=e.target.files[0]; 
    confirmMsg.style.display='block'; 
    confirmMsg.textContent='Video ready to upload!';
  };
  input.click();
});

uploadBtn.addEventListener('click',()=>{
  if(!selectedFile || !titleInput.value){ alert('Please select a video and enter a title.'); return; }
  const formData = new FormData();
  formData.append('file', selectedFile);
  formData.append('upload_preset', unsignedUploadPreset);

  fetch(`https://api.cloudinary.com/v1_1/${cloudName}/upload`, { method:'POST', body:formData })
  .then(res=>res.json())
  .then(data=>{
    const videoURL = data.secure_url;
    db.collection("videos").add({
      title: titleInput.value,
      url: videoURL,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    });
    confirmMsg.style.display='block';
    confirmMsg.textContent='Video uploaded successfully!';
    selectedFile=null;
    titleInput.value='';
  })
  .catch(err=>{ console.error(err); alert('Upload failed'); });
});

/* --- Real-time Video Display --- */
const gridContainer = document.getElementById('grid-container');
db.collection("videos").orderBy("timestamp").onSnapshot(snapshot=>{
  gridContainer.innerHTML='';
  snapshot.forEach(doc=>{
    const video = doc.data();
    const gridItem = document.createElement('div');
    gridItem.className='grid-item';
    gridItem.innerHTML=`
      <video controls>
        <source src="${video.url}" type="video/mp4">
      </video>
      <div class="label">${video.title}</div>
    `;
    gridContainer.appendChild(gridItem);
  });
});
</script>

</body>
</html>

